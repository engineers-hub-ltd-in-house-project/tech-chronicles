# 第5回ハンズオン：ホスティングサービス——cgroupsでVPSのリソース制限を体感する

## 概要

このハンズオンでは、VPS（Virtual Private Server）の技術的基盤であるLinuxのcgroupsを直接操作し、リソースの「切り売り」の仕組みを体感する。1台のサーバの物理リソースを複数の「テナント」に分配し、それぞれのリソース使用量を制限する——VPS事業者が行っていたことの本質を再現する。

## 学べること

- cgroupsによるCPU重み付けとCPU時間の分配
- メモリ制限（memory.max）の設定とOOM Killerの挙動
- 「Noisy Neighbor」問題の再現と、リソース隔離による緩和
- 共有ホスティング、VPS、専用サーバの隔離レベルの違いの実感

## 演習一覧

| 演習  | 内容                                               | 所要時間 |
| ----- | -------------------------------------------------- | -------- |
| 演習1 | cgroupsによるCPU制限——「リソースの切り売り」を再現 | 5分      |
| 演習2 | メモリ制限——「契約プラン」のリソース上限           | 5分      |
| 演習3 | 「Noisy Neighbor」問題の再現と緩和                 | 10分     |

## 動作環境

- Docker Desktop または Docker Engine
- ホストOS: Linux（WSL2含む）/ macOS / Windows
- `--privileged`オプションが必要（cgroup操作のため）
- 使用イメージ: `ubuntu:24.04`

## セットアップ

```bash
# 自動セットアップスクリプトの実行
bash setup.sh
```

## 注意事項

- `--privileged`オプションはコンテナにホストのほぼ全ての権限を与える。本番環境では使用しないこと
- cgroup v2環境を前提としている（Docker Desktop / 最近のLinuxディストリビューション）
- 演習3のNoisy Neighborテストでは、一時的にCPUを100%消費するプロセスを起動する

## ライセンス

MIT
