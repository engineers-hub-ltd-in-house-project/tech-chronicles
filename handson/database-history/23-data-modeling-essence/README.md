# 第23回ハンズオン: 同じ要件を3つの設計で実装する

## 概要

データモデリングに「唯一の正解」はない。同じビジネス要件（ECサイトの注文管理）に対して、正規化RDB設計、非正規化ドキュメント設計、イベントソーシング設計の3つのアプローチを実装し、各設計の得手不得手を体験する。

## 学べること

- **正規化RDB設計**: 第3正規形に従ったテーブル分割、外部キーによる関連管理、JOINによるデータ取得
- **非正規化ドキュメント設計**: PostgreSQL JSONBを使った埋め込みドキュメント、JOINなしの読み取り、更新時の冗長性コスト
- **イベントソーシング設計**: イベントストアへのappend-only書き込み、イベント再生による状態導出、任意時点の状態再現

## 演習一覧

| # | 演習内容                     | 設計アプローチ       | 主な学び                    |
| - | ---------------------------- | -------------------- | --------------------------- |
| 1 | 正規化スキーマとデータ投入   | 正規化RDB            | 外部キー、テーブル分割      |
| 2 | JOINによる注文一覧取得       | 正規化RDB            | 複数テーブル結合のコスト    |
| 3 | ドキュメント設計とデータ投入 | 非正規化ドキュメント | JSONB、埋め込みドキュメント |
| 4 | JOINなしの注文一覧取得       | 非正規化ドキュメント | 読み取り性能、データ冗長性  |
| 5 | イベントストアとイベント投入 | イベントソーシング   | append-only、イベント列     |
| 6 | イベント再生による状態導出   | イベントソーシング   | 状態の再構築、監査証跡      |

## 動作環境

- Docker（Docker Engine 20.10以上）
- bash（macOS/Linux/WSL2）

外部サービスへの登録は不要。すべてローカルのDockerコンテナで完結する。

## セットアップ

```bash
bash setup.sh
```

## 後片付け

```bash
docker stop pg-normalized && docker rm pg-normalized
```

## ライセンス

MIT
