# 第20回ハンズオン：pgvectorでセマンティック検索を体験する

## 概要

PostgreSQL + pgvectorを使い、テキストデータに対するセマンティック検索を実装する。キーワード検索との比較、HNSWインデックスの効果、フィルタリング付きベクトル検索を体験し、ベクトル検索の基本原理と実用パターンを理解する。

## 演習一覧

| 演習  | 内容                             | 学べること                                          |
| ----- | -------------------------------- | --------------------------------------------------- |
| 演習1 | PostgreSQL + pgvectorの起動      | pgvector拡張の有効化とベクトルカラムの作成          |
| 演習2 | キーワード検索 vs セマンティック | LIKE検索とベクトル類似度検索の結果の違い            |
| 演習3 | HNSWインデックスの作成と効果     | ベクトルインデックスの構造とEXPLAIN ANALYZEでの確認 |
| 演習4 | フィルタリング付きベクトル検索   | WHERE句とベクトル検索の組み合わせ（pgvectorの強み） |

## 動作環境

- Docker（pgvector/pgvector:pg17イメージを使用）
- psql（PostgreSQLクライアント）
- ネットワーク: Dockerイメージの取得にインターネット接続が必要

## セットアップ

```bash
bash setup.sh
```

## 後片付け

```bash
docker stop pgvector-handson && docker rm pgvector-handson
```

## 注意事項

- 本ハンズオンでは説明のために3次元の簡易ベクトルを使用する。実際のEmbeddingモデルは1536次元以上のベクトルを生成する
- 事前計算済みのベクトルを手動で設定しているため、外部APIへの接続は不要
- 実プロジェクトでは、OpenAIやCohere等のEmbedding APIでベクトルを生成し、アプリケーション層からpgvectorに格納する
- pgvectorのHNSWインデックスの効果は、数万件以上のデータで顕著になる。本ハンズオンの少量データではSeq Scanの方が速い場合がある
